{"code":"!function(t){var e={};function i(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)i.d(o,r,function(e){return t[e]}.bind(null,r));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=1)}([function(t,e){throw new Error(\"Module parse failed: Unexpected character '#' (1:0)\\nYou may need an appropriate loader to handle this file type.\\n> #tetris_container{\\n|     margin:auto 0;\\n|     text-align: center;\")},function(t,e,i){\"use strict\";i.r(e);class o{static create(t,e){const i=[];for(;e--;)i.push(new Array(t).fill(0));return i}static clone(t){let e=t.slice(0);for(let i=0;i<t[0].length;i++)e[i]=t[i].slice(0);return e}static merge(t,e,i){let o=this.clone(t);return e.forEach((t,e)=>{t.forEach((t,r)=>{console.log(t),0!==t&&(o[i.y+e][i.x+r]=t)})}),o}static rotate(t,e){const i=o.create(t.length,t[0].length),r=t[0].length,l=t.length;for(let e=0;e<l;e++)for(let o=0;o<r;o++){let n=t[o][e];i[o][e]=t[e][r-1-o],i[e][l-1-o]=t[r-1-o][l-1-e],i[r-1-o][l-1-e]=t[l-1-e][o],i[l-1-e][o]=n}return i}static draw(t,e,i){const o=[\"null\",\"Red\",\"Blue\",\"Green\",\"Yellow\",\"Purple\",\"Black\"];e.forEach((e,r)=>{e.forEach((e,l)=>{0!==e&&(t.fillStyle=\"Black\",t.fillRect(20*(i.x+l)+1,20*(i.y+r)+1,19,19),t.fillStyle=\"white\",t.fillRect(20*(i.x+l),20*(i.y+r),19,19),t.fillStyle=o[e],t.fillRect(20*(i.x+l)+1,20*(i.y+r)+1,18,18))})})}}i(0);const r=document.getElementById(\"tetris\"),l=r.getContext(\"2d\"),n=document.getElementById(\"tetris_side\").getContext(\"2d\");let s=null;const c=new class{constructor(t){this.widthX=140,this.heightY=400,this.blockSize=20,this.context=t}drawGameScore(t){this.context.fillStyle=\"Black\",this.context.fillRect(0*this.blockSize,0*this.blockSize,7*this.blockSize,3*this.blockSize),this.context.font=\"20px Arial\",this.context.fillStyle=\"White\",this.context.fillText(t,3.5*this.blockSize-this.context.measureText(t).width/2|0,2*this.blockSize)}drawNextPiece(t){this.nextPiece=t,this.context.fillStyle=\"Black\",this.context.fillRect(0*this.blockSize,11*this.blockSize,7*this.blockSize,5*this.blockSize),o.draw(this.context,t,{x:2,y:12})}drawSideBox(t,e){this.context.fillStyle=\"Black\",this.context.fillRect(0,0,190,190);for(let t=0;t<this.heightY/this.blockSize;t++)for(let e=0;e<this.widthX/this.blockSize;e++)this.context.fillStyle=\"Black\",this.context.fillRect(e*this.blockSize+1,t*this.blockSize+1,19,19),this.context.fillStyle=\"white\",this.context.fillRect(e*this.blockSize,t*this.blockSize,19,19),this.context.fillStyle=\"Grey\",this.context.fillRect(e*this.blockSize+1,t*this.blockSize+1,18,18);this.drawNextPiece(t),this.drawGameScore(e)}}(n),a=new class{constructor(t){this.matrix=t,this.pos={x:0,y:0},this.matrix=null,this.pieces={T:[[0,0,0],[1,1,1],[0,1,0]],L:[[0,2,0],[0,2,0],[0,2,2]],B:[[3,3],[3,3]],I:[[0,4,0,0],[0,4,0,0],[0,4,0,0],[0,4,0,0]],S:[[0,0,0],[0,5,5],[5,5,0]],J:[[0,0,2],[0,0,2],[0,2,2]],Z:[[0,0,0],[5,5,0],[0,5,5]]}}gravity(){return this.pos.y++,0}create(t){return this.pieces[t]}setup(t,e){return null===e&&(e=this.create(\"SZILJBT\"[Math.floor(\"SZILJBT\".length*Math.random())])),this.matrix=e,e=this.create(\"SZILJBT\"[Math.floor(\"SZILJBT\".length*Math.random())]),this.pos.y=0,this.pos.x=Math.floor(t/2)-Math.floor(this.matrix[0].length/2),e}isACollision(t){const{matrix:e,pos:i}=this;for(let o=0;o<e.length;o++)for(let r=0;r<e[o].length;r++)if(0!==e[o][r]&&0!==(t[i.y+o]&&t[i.y+o][i.x+r]))return!0;return!1}move(t,e){this.pos.x+=e,this.isACollision(t,this)&&(console.log(this.pos.x),this.pos.x-=e)}rotate(t,e){const i=this.pos.x;let r=1;for(this.matrix=o.rotate(this.matrix,e);this.isACollision(t,this);)if(this.pos.x+=r,(r=-(r+1))>this.matrix[0].length)return this.matrix=this.rotate(this.matrix,-e),void(this.pos.x=i)}};let h=0;const f=new class{constructor(t,e){this.gameMatrix=o.create(12,20)}clearGameMatrix(){this.gameMatrix.forEach(t=>t.fill(0))}setMatrix(t){this.gameMatrix=t}removeWholeRows(t){const e=this.gameMatrix;let i=1;for(let o=e.length-1;o>=0;o--){let r=!0;for(let t=0;t<e[0].length;t++)0===e[o][t]&&(r=!1);!0===r&&(e.splice(o,1),e.unshift(new Array(e[0].length).fill(0)),o++,t+=10*i,i*=2)}return t}}(12,20);let x=0,u=1e3,d=0;document.addEventListener(\"keydown\",t=>{const e=f.gameMatrix;console.log(t.code);const i={ArrowRight:()=>a.move(e,1),ArrowLeft:()=>a.move(e,-1),ArrowDown:()=>x=a.gravity(),ArrowUp:()=>a.rotate(e,1)};i[t.code]&&i[t.code]()}),s=a.setup(f.gameMatrix,s),function t(e=0){const i=e-d;d=e,(x+=i)>u&&(x=a.gravity()),a.isACollision(f.gameMatrix,a)&&(a.pos.y--,f.setMatrix(o.merge(f.gameMatrix,a.matrix,a.pos)),h=f.removeWholeRows(h),s=a.setup(f.gameMatrix[0].length,s)),function(){const t=f.gameMatrix;return!!a.isACollision(t,a)}()&&(f.clearGameMatrix(),h=0),function(){const t=f.gameMatrix;l.fillStyle=\"#000\",l.fillRect(0,0,r.width,r.height),o.draw(l,a.matrix,a.pos),o.draw(l,t,{x:0,y:0}),c.drawSideBox(s,h)}(),requestAnimationFrame(t)}()}]);","extractedComments":[]}